#pragma once
#ifdef SIMULATION#include "Arduino_Mock.h"
#else
#include <avr/pgmspace.h>
#endif

#include "../Image.h"

namespace rocket_data {
	const uint16_t arcs[] PROGMEM {
		  0x0000
		, 0x0000, 0x15E1, 0x2530
		, 0x0000, 0x1119, 0x2B68
		, 0x0000, 0x0E61, 0x2F58
		, 0x0000, 0x0DF9, 0x3130
		, 0x0000, 0x0D69, 0x3210
		, 0x0000, 0x06B2, 0x0ED9, 0x31D8
		, 0x0001, 0x02B2, 0x0653, 0x0FDA, 0x1219, 0x3078, 0xFBE9
		, 0x0001, 0x0732, 0x087B, 0x1242, 0x1381, 0x24E8, 0x25C9, 0x2C20, 0xF711
		, 0x0001, 0x039A, 0x0401, 0x0462, 0x0933, 0x099A, 0x0A61, 0x0ACA, 0x0B31, 0x10CA, 0x1399, 0x1462, 0x1801, 0x2398, 0xF402, 0xF999
		, 0x0002, 0x024B, 0x0A4A, 0x0AA9, 0x1432, 0x1493, 0x1982, 0x1CF1, 0x2490, 0xF182, 0xF24B, 0xFB0A, 0xFDB1, 0xFE1A
		, 0x0003, 0x0AD2, 0x0B31, 0x1493, 0x1CE1, 0x2AF0, 0xEF62, 0xF01B, 0xF982, 0xFBA9, 0xFE8A
		, 0x0001, 0x00AA, 0x0103, 0x0B49, 0x143A, 0x148B, 0x1C71, 0x2E98, 0xED7A, 0xEE2B, 0xF662, 0xF819
		, 0x0001, 0x01A2, 0x01FB, 0x0B29, 0x1362, 0x140B, 0x1B9A, 0x1BE9, 0x3198, 0xEC49, 0xECF2, 0xED41, 0xF2DA, 0xF5D1
		, 0x0001, 0x0233, 0x0AAA, 0x0AF9, 0x0B9A, 0x1281, 0x1322, 0x1AF9, 0x3410, 0xEAF9, 0xF282, 0xF3C3, 0xF552, 0xF691
		, 0x0001, 0x0263, 0x03E2, 0x0779, 0x0A32, 0x0A7B, 0x107A, 0x11A9, 0x2870, 0x2C11, 0x3640, 0xE9D1, 0xF0B2, 0xF1EB, 0xF702, 0xF831
		, 0x0002, 0x0251, 0x0942, 0x09D3, 0x0C22, 0x0D48, 0x0D9A, 0x0DE0, 0x1439, 0x26C0, 0x2FB9, 0x37D0, 0xE8D9, 0xEF82, 0xF063, 0xF87A, 0xF909
		, 0x0003, 0x01AA, 0x01F1, 0x0808, 0x14C9, 0x2260, 0x3231, 0x3920, 0xE821, 0xEDFA, 0xEF13, 0xF912, 0xF999, 0xFC62, 0xFE9B
		, 0x0003, 0x00CA, 0x0151, 0x03B8, 0x1509, 0x2258, 0x3479, 0x3D40, 0xE779, 0xED12, 0xEDE3, 0xF952, 0xF999, 0xF9DA, 0xFB33
		, 0x0002, 0x0041, 0x0080, 0x15A9, 0x2250, 0x3631, 0x3EF0, 0xE6F1, 0xEDEA, 0xEF7B, 0xF6F2, 0xF841, 0xF9CA, 0xFA13, 0xFF3A
		, 0x0000, 0x1619, 0x2248, 0x3829, 0x4018, 0xE661, 0xF012, 0xF0D3, 0xF492, 0xF5C9, 0xF9CA, 0xFA0B, 0xFC42, 0xFCC0
		, 0x0000, 0x16C1, 0x2240, 0x3851, 0x4130, 0xE619, 0xF122, 0xF19B, 0xF292, 0xF3C1, 0xF94A, 0xFA38
		, 0x0000, 0x1749, 0x2278, 0x3859, 0x41B0, 0xE5A9, 0xF7D8
		, 0x0000, 0x1811, 0x22A8, 0x38B9, 0x41F8, 0xE531, 0xF5A0
		, 0x0000, 0x18A1, 0x2318, 0x3959, 0x4248, 0xE4F1, 0xF390
		, 0x0000, 0x1979, 0x23A8, 0x39F1, 0x4238, 0xE4D1, 0xF190
		, 0x0000, 0x1A21, 0x2468, 0x3AA1, 0x41D8, 0xE4A1, 0xEFB8
		, 0x0000, 0x1AC1, 0x25C0, 0x3B59, 0x4188, 0xE469, 0xEE30
		, 0x0000, 0x1B79, 0x2668, 0x3FF1, 0x4020, 0xE451, 0xEC48
		, 0x0000, 0x1C71, 0x26D8, 0xE419, 0xEAC0
		, 0x0000, 0x1DB1, 0x26E8, 0xE421, 0xE920
		, 0x0000, 0x1F61, 0x2668, 0xE409, 0xE770
		, 0x0000, 0x21B9, 0x2510, 0xE411, 0xE5A0
		, 0x0000
		, 0x0000
		, 0x0000
	}; // 586 bytes

	const uint16_t row_ends[] PROGMEM {		
		0x0000, 0x0003, 0x0006, 0x0009, 0x000C, 0x000F, 0x0013, 0x001A, 
		0x0023, 0x0033, 0x0041, 0x004C, 0x0058, 0x0066, 0x0074, 0x0084, 
		0x0095, 0x00A4, 0x00B3, 0x00C2, 0x00D0, 0x00DC, 0x00E3, 0x00EA, 
		0x00F1, 0x00F8, 0x00FF, 0x0106, 0x010D, 0x0112, 0x0117, 0x011C, 
		0x0121, 0x0122, 0x0123, 0x0124
	}; // 72 bytes

	const uint32_t colors[] PROGMEM {		
		0x00000000, 0x00FF0000, 0x00FF9999, 0x00FFFFFF
	}; // 16 bytes
}

class rocket : public Image {
protected:
	inline uint16_t get_arc(uint16_t i) override {
		return pgm_read_word(&rocket_data::arcs[i]);
	}

	inline uint16_t get_row_end(uint8_t row_index) override {
		return pgm_read_word(&rocket_data::row_ends[row_index]);
	}

protected:
	const uint16_t angle_mask = 0xFFF8;
	const uint16_t color_mask = 0x0007;

	inline uint16_t get_angle(uint16_t arc) override {
		return arc & angle_mask;
	}

	inline uint32_t get_color(uint16_t arc) override {
		return pgm_read_dword(&(rocket_data::colors[arc & color_mask]));
	}
};
